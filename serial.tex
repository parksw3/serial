\documentclass[12pt]{article}
\usepackage[top=1in,left=1in, right = 1in, footskip=1in]{geometry}

\usepackage{graphicx}
\usepackage{xspace}
%\usepackage{adjustbox}

\newcommand{\comment}{\showcomment}
%% \newcommand{\comment}{\nocomment}

\newcommand{\showcomment}[3]{\textcolor{#1}{\textbf{[#2: }\textsl{#3}\textbf{]}}}
\newcommand{\nocomment}[3]{}

\newcommand{\jd}[1]{\comment{cyan}{JD}{#1}}
\newcommand{\swp}[1]{\comment{magenta}{SWP}{#1}}
\newcommand{\bmb}[1]{\comment{blue}{BMB}{#1}}
\newcommand{\djde}[1]{\comment{red}{DJDE}{#1}}

\newcommand{\eref}[1]{Eq.~(\ref{eq:#1})}
\newcommand{\fref}[1]{Fig.~\ref{fig:#1}}
\newcommand{\Fref}[1]{Fig.~\ref{fig:#1}}
\newcommand{\sref}[1]{Sec.~\ref{#1}}
\newcommand{\frange}[2]{Fig.~\ref{fig:#1}--\ref{fig:#2}}
\newcommand{\tref}[1]{Table~\ref{tab:#1}}
\newcommand{\tlab}[1]{\label{tab:#1}}
\newcommand{\seminar}{SE\mbox{$^m$}I\mbox{$^n$}R}

\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage[utf8]{inputenc} % make sure fancy dashes etc. don't get dropped

\usepackage{lineno}
\linenumbers

\usepackage[pdfencoding=auto, psdextra]{hyperref}

\usepackage{natbib}
\bibliographystyle{chicago}
\date{\today}

\usepackage{xspace}
\newcommand*{\ie}{i.e.\@\xspace}

\usepackage{color}

\newcommand{\Rx}[1]{\ensuremath{{\mathcal R}_{#1}}\xspace} 
\newcommand{\Ro}{\Rx{0}}
\newcommand{\Rc}{\Rx{\mathrm{c}}}
\newcommand{\Rs}{\Rx{\mathrm{s}}}
\newcommand{\RR}{\ensuremath{{\mathcal R}}\xspace}
\newcommand{\Rhat}{\ensuremath{{\hat\RR}}}
\newcommand{\Rintrinsic}{\ensuremath{{\mathcal R}_{\textrm{\tiny intrinsic}}}\xspace}
\newcommand{\tsub}[2]{#1_{{\textrm{\tiny #2}}}}
\newcommand{\dd}[1]{\ensuremath{\, \mathrm{d}#1}}
\newcommand{\dtau}{\dd{\tau}}
\newcommand{\dx}{\dd{x}}
\newcommand{\dsigma}{\dd{\sigma}}

\newcommand{\psymp}{\ensuremath{p}} %% primary symptom time
\newcommand{\ssymp}{\ensuremath{s}} %% secondary symptom time
\newcommand{\pinf}{\ensuremath{\alpha_1}} %% primary infection time
\newcommand{\sinf}{\ensuremath{\alpha_2}} %% secondary infection time

\newcommand{\psize}{{\mathcal P}} %% primary cohort size
\newcommand{\ssize}{{\mathcal S}} %% secondary cohort size

\newcommand{\gtime}{\tau_{\rm g}} %% generation interval
\newcommand{\gdist}{g} %% generation-interval distribution
\newcommand{\idist}{\ell} %% incubation period distribution

\newcommand{\total}{{\mathcal T}} %% total number of serial intervals

\usepackage{lettrine}

\newcommand{\dropcapfont}{\fontfamily{lmss}\bfseries\fontsize{26pt}{28pt}\selectfont}
\newcommand{\dropcap}[1]{\lettrine[lines=2,lraise=0.05,findent=0.1em, nindent=0em]{{\dropcapfont{#1}}}{}}

\begin{document}

\begin{flushleft}{
	\Large
	\textbf\newline{
		Cohort-based approach to understanding the roles of generation and serial intervals in shaping epidemiological dynamics
	}
}
\newline
\\
Sang Woo Park\textsuperscript{1,*}
Kaiyuan Sun\textsuperscript{2}
David Champredon\textsuperscript{3}
Michael Li\textsuperscript{4}
Benjamin M.\ Bolker\textsuperscript{4,5,6}
David J.\,D.\ Earn\textsuperscript{5,6}
Joshua S.\ Weitz\textsuperscript{7, 8}
Bryan T.\ Grenfell\textsuperscript{1,2,9}
Jonathan Dushoff\textsuperscript{4,5,6}
\\
\bigskip
\textbf{1} Department of Ecology and Evolutionary Biology, Princeton University, Princeton, NJ, USA
\\
\textbf{2} Fogarty International Center, National Institutes of Health, Bethesda, MD, USA
\\
\textbf{3} Department of Pathology and Laboratory Medicine, University of Western Ontario, London, Ontario, Canada
\\
\textbf{4} Department of Biology, McMaster University, Hamilton, ON, Canada
\\
\textbf{5} Department of Mathematics and Statistics, McMaster University, Hamilton, ON, Canada
\\
\textbf{6} M.\,G.\,DeGroote Institute for Infectious Disease Research, McMaster University, Hamilton, ON, Canada
\\
\textbf{7} School of Biological Sciences, Georgia Institute of Technology, Atlanta, GA, USA
\\
\textbf{8} School of Physics, Georgia Institute of Technology, Atlanta, GA, USA
\\
\textbf{9} Woodrow Wilson School of Public and International Affairs, Princeton University, Princeton, NJ, USA
\\
\bigskip

*Corresponding author: swp2@princeton.edu
\bigskip

Disclaimer: The findings and conclusions in this report are those of the authors and do not necessarily represent the official position of the U.S. National Institutes of Health or Department of Health and Human Services.
\end{flushleft}

\pagebreak

\section*{Abstract}

The reproduction number \RR and the exponential growth rate $r$ are critical quantities for characterizing outbreak dynamics.
These quantities are linked by generation intervals---defined as the time between infection and transmission.
Because generation intervals are difficult to measure directly, they are often substituted with serial intervals---defined as the onset of symptoms in a chain of transmission.
While serial intervals are easier to measure from contact tracing, recent studies suggest that the two intervals give different estimates of \RR from $r$.
We present a general framework for characterizing epidemiological delays based on cohorts (i.e., a group of individuals that share the same event time, such as symptom onset) and show that \emph{forward-looking} serial intervals, which correctly link \RR with $r$, are not the same as ``intrinsic'' serial intervals, but instead change with $r$.
We provide a heuristic method for addressing potential biases that can arise from not accounting for changes in serial intervals across cohorts and apply the method to estimating \RR for the COVID-19 outbreak in China using serial-interval data --- our analysis shows that using incorrectly defined serial intervals can bias estimates of initial \RR by up to 50\%--60\%.
This study demonstrates the importance of early epidemiological investigation through contact tracing and provides a rationale for reassessing generation intervals, serial intervals, and \RR\ estimates, for COVID-19.

\section*{Significance Statement}

The generation- and serial-interval distributions are key, but different, quantities in outbreak analyses.
Recent theoretical studies suggest that two distributions give different estimates of the reproduction number \RR from the exponential growth rate $r$;
however, both intervals, by definition, describe disease transmission at the individual level.
Here, we show that the serial-interval distribution, defined from the correct reference time and cohort, gives the same estimate of \RR as the generation-interval distribution.
We then apply our framework to serial-interval data from the COVID-19 outbreak in China.
While our study supports the use of serial-interval distributions in estimating \RR, it also reveals necessary changes to the current understanding and applications of serial-interval distribution.

\pagebreak

\section{Introduction}

The reproduction number \RR is one of the most important characteristics of an emerging epidemic, including the current pandemic of coronavirus disease 2019 (COVID-19) \citep{majumder2020early}.
The reproduction number is defined as the average number of secondary cases caused by a primary case;
the value in a fully susceptible population --- the ``basic'' reproduction number \Ro --- allows us to predict the extent to which an infection will spread in the population, and the amount of intervention necessary to eliminate it \citep{anderson1991infectious}.
Since the reproduction number represents an average \citep{diekmann1990definition, anderson1991infectious}, it does not capture heterogeneity among individuals or across space.
The reproduction number also does not provide any information about the time scale of disease transmission.

Estimating the reproduction number \RR is challenging because it cannot be measured directly.
It often requires a detailed knowledge of the disease history and reliable incidence data.
Instead, near the beginning of an epidemic, \RR can be estimated from the population-level exponential growth rate.
This approach is convenient because the growth rate can be estimated robustly from case reports \citep{mills2004transmissibility, ma2014estimating}.
These two quantities, representing the speed $r$ and strength $\RR$ of an epidemic, are linked by the generation-interval distribution \cite{wallinga2007generation}, where the generation interval is defined as the time between when an individual (infector) is infected and when that individual infects another person (infectee) \citep{svensson2007note}.

Since generation intervals measure time between infection events, which can be difficult to observe in practice, generation intervals are often replaced with serial intervals.
The serial interval is defined as the time between when an infector and an infectee become \emph{symptomatic} \citep{svensson2007note}.
While generation and serial intervals both measure the time scale of disease transmission, they measure fundamentally different quantities. 
In particular, previous studies have noted that, in many contexts, serial intervals are expected to have larger variances than generation intervals but have the same mean, assuming that the incubation periods of the infector and infectee are identically distributed \citep{svensson2007note,klinkenberg2011correlation,te2013estimating,champredon2018equivalence}.
Serial intervals can also take negative values due to presymptomatic transmission \citep{he2020temporal}, whereas generation intervals are confined to positive values.

Although these distributions were clearly and distinctly defined over a decade ago \citep{svensson2007note}, 
the need for a better conceptual and theoretical framework for understanding their differences is becoming clearer as the COVID-19 pandemic unfolds.
Researchers continue to rely on both generation and serial intervals to make inferences about COVID-19 without making a clear distinction (e.g., \citep{tempvar,du2020serial,he2020temporal,wu2020nowcasting,zhao2020serial}), and explicitly conflate the definitions of two intervals (e.g., \citep{anderson2020will,hellewell2020feasibility}).
The lack of distinction is apparent even in standard software for estimating \RR, such as \texttt{EpiEstim}, in which the serial-interval distribution is used to infer time-dependent \RR \citep{thompson2019improved}.
However, these studies should not be accused of their practices; until now, it has been a common practice use serial and generation intervals interchangeably.

One source of confusion arises from an apparent discrepancy between the serial-interval and generation-interval viewpoints.
When the epidemic is growing exponentially, the spread of infection can be characterized as a \emph{renewal process} based on previous incidence of infection, the associated generation-interval distribution, and the average infectiousness of an infected individual.
It is well established that this renewal formulation allows us to link the exponential growth rate of an epidemic $r$ with its reproduction number \RR using the generation-interval distribution \citep{wallinga2007generation}.
By definition, the serial-interval distribution describes the renewal process between symptomatic cases based on their symptom onset dates.
Since both renewal processes, based on generation- and serial-interval distributions, describe the same underlying system of exponential growth, both should provide the same correct link between the reproduction number \RR and the epidemic growth rate $r$.

In contexts where the distributions are expected to be different, current theory has no explanation for how these differing distributions could provide identical estimates of \RR from $r$. 
In fact, recent theory suggest that using serial-interval can underestimate the reproduction number \citep{britton2019estimation, ganyani2020estimating}.
However, these studies rely on imprecise definitions of the serial-interval distribution, relying on \emph{intrinsic} distributions of incubation periods and generation intervals that neglect the population-level dynamics of the disease spread.
During an ongoing epidemic, \emph{all} observed epidemiological delays between primary and secondary events (e.g., infection and symptom onset) are subject to backward biases: when incidence of primary events is increasing (or decreasing), we are more likely to observe shorter (or longer) intervals.
Since serial intervals depend on three distinct intervals (i.e., incubation period of the infector, incubation period of the infectee, and the generation interval between them), any of these intervals can be subject to backward biases depending on our perspective.
Therefore, it is not always safe to assume that the incubation periods of the infector and the infectee are drawn from the same distribution.

Here, we resolve this apparent discrepancy by showing that the relevant interval for the renewal framework is what is called the ``forward'' interval, and that the forward serial intervals are different from the ``intrinsic'' serial intervals that previous studies have relied on \citep{svensson2007note,klinkenberg2011correlation,te2013estimating,champredon2018equivalence, britton2019estimation}.
We develop a cohort-based framework for characterizing and comparing serial intervals, as well as any other epidemiological delays, and show that the initial forward serial-interval distribution correctly estimates \RR from $r$.
Conversely, using inaccurately defined serial intervals or failing to account for changes in the observed serial-interval distributions over the course of an epidemic can considerably bias estimates of \RR.
For example, in our analysis of the COVID-19 serial intervals from China, we find that the original \Ro esimates based on aggregated serial interval data underestimated \Ro by 50\%--60\%.
We further lay out several principles to consider in using information about serial intervals and other epidemiological time delays to correctly infer the initial reproduction number during the early stages of an outbreak.

\section{Methods}

\subsection{Intrinsic, forward, and backward delay distributions}

The time delays between two epidemiological events can be defined either within an infected individual (e.g., incubation period: infection and symptom onset of an individual) or between infected individuals (e.g., serial interval: symptom onsets of an infector and an infectee).
We can further divide these events into \emph{primary} and \emph{secondary} events.
When we measure an epidemiological time delay within an infected individual (e.g., the incubation period), the primary event usually occurs before the secondary event ---
most epidemiological events that can be observed within an individual have clear direction (e.g., infection to onset of symptoms) but some may not (e.g., onset of infectiousness and onset of symptoms).
When we measure an epidemiological time delay between infected individuals (e.g., the serial interval), 
the primary and secondary events are defined in terms of the direction of transmission:
the primary event refers to the event that occurs in the infector. 
Again, some of these delays are always positive (the infector is always infected before the infectee) and some are not (it is possible for the infectee to develop symptoms before the infector \citep{he2020temporal}).

At the individual level, we can define the time distribution between a primary and a secondary event that we expect to observe (averaged across individual characteristics) for an infected individual --- we refer to this distribution as the intrinsic distribution.
For example, the intrinsic incubation period distribution describes the expected time distribution from infection to symptom onset of an infected individual.
Likewise, the intrinsic generation-interval distribution describes the expected time distribution of infectious contacts made by an infected individual.
However, the intrinsic time distributions are not always equivalent to the corresponding realized time distributions at the population level (i.e., the distribution of time between actual primary and secondary events that occur during an epidemic; see \fref{diagram}).
For example, an infectious contact results in infection only if the contacted individual is susceptible (and has not already been infected);
this is one mechanism that causes realized generation intervals (time between actual infection events) to differ from from the intrinsic generation intervals (time between infection and infectious contacts).

At the population level, we model realized time delays between a primary and a secondary event from a cohort perspective.
A cohort consists of \emph{all} individuals whose (primary or secondary) event occurred at a given time. 
For example, when we are measuring incubation periods, a primary cohort consists of all individuals who became infected at time \psymp, while a secondary cohort consists of all individuals whose symptom onset occurred at time $\ssymp$.
Similarly, when we are measuring serial intervals, a primary cohort consists of all infectors who became symptomatic at time $\psymp$.
Then, for a primary cohort at time $\psymp$, we can define the expected time distribution between primary and secondary events. 
We refer to this distribution as the forward delay distribution and denote it as $f_\psymp(\tau)$.

Likewise, we define the backward delay distribution $b_\ssymp(\tau)$ for a secondary cohort at time $\ssymp$:
The backward delay distribution describes the time delays between a primary and secondary host given that the secondary event occurred at time $\ssymp$.
For example, the backward incubation period distribution at time $\ssymp$ describes incubation periods for a \emph{cohort} of individuals who became symptomatic at time $\ssymp$.
Likewise, the backward serial-interval distribution at time $\ssymp$ describes serial intervals for a \emph{cohort} of infectees who became symptomatic at time $\ssymp$.

Both forward and backward perspectives
must yield identical \emph{measurement} (e.g., the length of the incubation
period of a given individual is the same whether measured forward from
the time of infection or backward from the time of symptom onset).
Consequently, no matter how delays are distributed, if
$\mathcal P$ and $\mathcal S$ represent the sizes of primary and
secondary cohorts then we can express the total density of intervals $\tau$ between calendar time $\psymp$ and $\ssymp$ (i.e., $\tau=\ssymp-\psymp$) as follows:
\begin{equation}
W(\psymp) \psize(\psymp) f_\psymp(\tau) = \ssize(\ssymp) b_\ssymp(\tau) \,,
\label{eq:match}
\end{equation}
where $W(\psymp)$, the ``weight'' of the primary cohort, represents the average number of forward intervals that an individual in cohort $\psize(\psymp)$ produces over the course of their infection.
When we measure within-individual delays, we expect $W(\psymp) \leq 1$ because only a subset of individuals who experience the primary event (e.g., infection) will eventually experience the secondary event (e.g., symptom onset).
For between-individual delays, we expect $W(\psymp)$ to change throughout an epidemic, because individuals infected earlier in an epidemic will infect more individuals on average than those infected later.

Substituting $\psymp=\ssymp-\tau$, it follows that
\begin{equation}
b_\ssymp(\tau)= \frac{W(\ssymp-\tau) \psize(\ssymp-\tau) f_{\ssymp-\tau} (\tau)}{\ssize(\ssymp)}\,.
\label{eq:backward}
\end{equation}
If we are considering incubation periods, the left hand side of
this equation is the probability density that an individual
who became symptomatic at time $\ssymp$ had an incubation period of
length $\tau$.
From the right hand side, we see that this probability density depends on the weight parameter $W(\ssymp-\tau)$ (in this case, the proportion of symptomatic infection),
the time-varying primary cohort size at the earlier time $\psize(\ssymp-\tau)$ (in this case, the number of individuals infected at time $\ssymp-\tau$),
and the forward delay distribution $f_{\ssymp-\tau}(\tau)$ (in this case, the probability density that an incubation period that starts at time $\ssymp-\tau$ ends at time $\ssymp$).

Several different mechanisms drive the changes in forward and backward delay distributions over time.
Typically, within-individual forward delay distributions are not directly affected by epidemic dynamics.
Some realized distributions, like incubation period distributions, are expected to be equivalent to their intrinsic distributions and remain invariant at the time scale of an outbreak.
Other realized distributions, like the distribution of time from symptom onset to testing, may change over the course of an epidemic due to changes in public health policies.
Between-individual forward delay distributions, such as generation- or serial-interval distributions, depend on epidemic dynamics.
For example, infected individuals can become less likely to infect others during late stages of their infection as the epidemic progresses (therefore, leading to ``contraction'' of generation intervals) due to factors that drive time-dependent decreases in transmission such as susceptible depletion, behavioral change, and interventions \citep{champredon2015intrinsic}.

\eref{backward} suggests that backward delay distributions change over time even if their corresponding forward delay distribution does not change.
Backward delay distributions depend on changes in the primary cohort size over time due to conditionality of observations:
Conditioning on individuals whose secondary events have occurred at the same time means that we tend to observe shorter (or longer) inter-event delays when cohort size has been increasing (decreasing) through time.
When incidence is growing exponentially, we can calculate the amount of bias exactly.
Assuming that the forward delay distribution ($f_\psymp(\tau) \approx f_0(\tau)$) and the weight parameter ($W(\psymp) \approx W(0)$) remain constant during the exponential growth phase, we can substitute $\psize(t) = \psize(0) \exp(rt)$ in \eref{backward} to obtain:
\begin{align}
b_0(\tau) &= \left[ W(0) \psize(0)/\ssize(0)\right] \exp(-r\tau) f_0(\tau)
\label{eq:backexp}
\end{align}
where $r$ is the exponential growth rate (and $\left[W(0) \psize(0)/\ssize(0)\right]^{-1} = \int_{-\infty}^{\infty} \exp(-r\tau') f_0(\tau') \dtau'$ since $b_0$ is a probability distribution).
Thus, even for different epidemics of the same disease, we expect to observe shorter backward intervals within a fast-growing epidemic (high $r$), assuming all else being equal.
In general, the backward delay distribution will differ from the forward delay distribution (unless the disease is at equilibrium), even if we are measuring time delays that are intrinsic to the life history of a disease (e.g., the incubation period).
These ideas apply to all epidemiological delay distributions and generalize the work by \cite{champredon2015intrinsic} who compared forward and backward generation-interval distributions to describe realized generation intervals from the perspective of an infector and an infectee, respectively, as well as the work by \cite{britton2019estimation} who showed that \eref{backexp} holds for the backward generation-interval distributions.

\subsection{Realized serial-interval distributions}

The serial interval is defined as the time between when an infector becomes symptomatic and when an infectee becomes symptomatic \citep{svensson2007note}.
Previous studies have often expressed serial intervals $\tau_{\rm s}$ in the form (\fref{diagram}A):
\begin{equation}
\tau_{\rm s} = (\gtime + \tau_{\rm i2}) - \tau_{\rm i1}
\label{eq:intser}
\end{equation}
where $\tau_{\rm i1}$ and $\tau_{\rm i2}$ represent incubation periods of an infector and
an infectee, respectively, and $\gtime$ represents the generation
interval between the infector and the infectee.
These studies concluded that the serial and generation intervals have the same mean when $\tau_{\rm i1}$ and $\tau_{\rm i2}$ are drawn from the same distributions \citep{svensson2007note,klinkenberg2011correlation,champredon2018equivalence, britton2019estimation};
however, distributions of realized incubation periods, $\tau_{\rm i1}$ and $\tau_{\rm i2}$ will be identical only if we assume that they are intrinsic to individuals (and not dependent on epidemic dynamics at the population-level) ---
something that is generally true of forward but not backward incubation-period distributions.
We refer to the definition \eref{intser} as the intrinsic serial interval (\fref{diagram}A).

\begin{figure}[!th]
\includegraphics[width=\textwidth]{serial_guide.pdf}
\caption{\textbf{Illustration of intrinsic,
    forward and backward serial intervals.}  (A) The intrinsic serial
  interval for a cohort of individuals infected at time $\psymp$.  In
  this case, $\tau_{\rm i1}$ is drawn from the intrinsic incubation period
  distribution; $\gtime$ is drawn from the intrinsic generation-interval
  distribution; and $\tau_{\rm i2}$ is drawn from the intrinsic incubation period
  distribution.  (B) The forward serial interval for a cohort of
  infectors who became symptomatic at time $\psymp$.  In this case,
  $\tau_{\rm i1}$ is drawn from the backward incubation period distribution; $\gtime$
  is drawn from the forward generation-interval distribution; and $\tau_{\rm i2}$
  is drawn from the forward incubation period distribution.  (C) The
  backward serial interval for a cohort of infectees who became
  symptomatic at time $\ssymp$.  In this case, $\tau_{\rm i1}$ is drawn from the
  forward incubation period distribution; $\gtime$ is drawn from the
  backward generation-interval distribution; and $\tau_{\rm i2}$ is drawn from the
  backward incubation period distribution.}
\label{fig:diagram}
\end{figure}

To correctly link the realized serial-interval distribution to the renewal process
between cases based on symptom onset dates, we must use the forward
serial interval (i.e., use the perspective of a cohort of infectors
that share the same symptom onset time).  Given that an infector
became symptomatic at time $\psymp$, to calculate the forward serial
interval we first go backward in time to when the infector was
infected, and then forward in time to when the infectee was infected,
and then forward to when the infectee became symptomatic.
In \fref{diagram}B, we see that $\tau_{\rm i1}$ is drawn from
the backward incubation period distribution of the cohort
of infectors who became symptomatic at time $\psymp$; $\gtime$ is drawn from
the forward generation-interval distribution of the cohort of
infectors who became infected at time $\psymp - \tau_{\rm i1}$; and $\tau_{\rm i2}$
is drawn from the forward incubation period distribution of the cohort of
infectees who became infected at time $\psymp - \tau_{\rm i1} + \gtime$.
Likewise, we can define the backward serial-interval distribution for
a cohort of infectees who became symptomatic at time $\ssymp$
(\fref{diagram}C).  This conceptual framework demonstrates
that the distributions of $\tau_{\rm i1}$, $\gtime$, and $\tau_{\rm i2}$ (and therefore
the distributions of realized serial intervals) depend on the
reference cohort, which is defined by an event type (primary or secondary),
temporal direction (forward or backward), and a particular reference time.

To calculate realized serial-interval distributions, we begin by modeling $\total(\psymp,\ssymp)$: the total density of serial intervals that start (when infectors develop symptoms) at time $\psymp$ and end (when infectees develop symptoms) at time $\ssymp$.
For simplicity, we assume that all infected individuals eventually develop symptoms.
Then, the density of serial intervals between time $\psymp$ and $\ssymp$,
given that the infectors became infected at time $\pinf\le\psymp$ and
the infectees became infected at time $\sinf\le\ssymp$, depends on the
amount of infection that occurs between time $\pinf$ and $\sinf$ as well as
the density of forward incubation periods between $\pinf$ and
$\psymp$ (realized incubation periods of infectors) and between
$\sinf$ and $\ssymp$ (realized incubation periods of infectees):
\begin{equation}
\underbrace{\Rc (\pinf)}_{\substack{\text{case} \\ \text{reproduction} \\ \text{number}}} 
\times 
\underbrace{i(\pinf)}_{\substack{\text{incidence} \\ \text{of} \\ \text{infection}}} 
\times 
\underbrace{h_{\pinf}(\psymp-\pinf, \sinf - \pinf)}_{\substack{\text{joint density of} \\ \text{forward incubation} \\ \text{periods } p-\pinf \text{ and forward} \\ \text{generation intervals } \sinf-\pinf\\ \text{(of infectors)}}}
\times
\underbrace{\idist_{\sinf}(\ssymp - \sinf)}_{\substack{\text{marginal density of} \\ \text{forward incubation} \\ \text{periods } \ssymp-\sinf \\ \text{(of infectees)}}},
\end{equation}
where the case reproduction number $\Rc (\pinf)$ is defined as the average number of secondary cases that a primary case infected at time $\pinf$ will generate over the course of their infection \citep{fraser2007estimating}.
We describe the forward incubation periods and the forward generation intervals using a joint probability distribution because onset of symptoms and transmission potential jointly depend on the life history of a disease;
for example, if an infected individual can only transmit the disease after symptom onset, the forward generation interval will necessarily be longer than the forward incubation period.

The total density of serial intervals can now be obtained by integrating over all possible infection times for the infector and the infectee:
\begin{equation}
\total (\psymp,\ssymp) = \int_{-\infty}^{\psymp} \int_{\pinf}^{\ssymp} \Rc (\pinf) i(\pinf) h_{\pinf}(\psymp-\pinf, \sinf - \pinf) \idist_{\sinf}(\ssymp - \sinf) \, \mathrm{d}\sinf\,\mathrm{d}\pinf.
\end{equation}
Then, the forward serial-interval distribution $f_\psymp(\tau)$ is given by the density of intervals of length $\tau$ starting at time \psymp, relative to the total number of serial intervals starting at time \psymp: 
\begin{equation}
f_\psymp(\tau) = 
\frac{\total(\psymp, \psymp+\tau)}{\int_{-\infty}^\infty \total(\psymp, \psymp+\tau') \dtau'}.
\label{eq:fserial}
\end{equation}
Likewise, the backward serial-interval distribution $b_\ssymp(\tau)$ is given by the density of intervals of length $\tau$ ending at \ssymp, relative to the total number of serial intervals ending at \ssymp: 
\begin{equation}
b_\ssymp(\tau) = 
\frac{\total(\ssymp-\tau, \ssymp)}{\int_{-\infty}^\infty \total(\ssymp-\tau', \ssymp) \dtau'}.
\label{eq:bserial}
\end{equation}

We see that the denominator of the forward serial-interval distribution, $\int_{-\infty}^\infty \total(\psymp, \psymp+\tau') \dtau'$, then corresponds to the total number of symptomatic cases generated by primary cases who themselves developed symptoms at time \psymp\ (\eref{fserial}).
Dividing this quantity by the number of individuals who developed symptoms at time at time \psymp, $j(\psymp) = \int_{-\infty}^\infty \total(\psymp-\tau', \psymp) \dtau'$, we obtain the serial reproduction number:
\begin{equation}
\Rs(\psymp) = \frac{\int_{-\infty}^\infty \total(\psymp, \psymp+\tau') \dtau'}{j(\psymp)},
\end{equation}
which we define as the average number of symptomatic cases generated by individuals who developed symptoms at time \psymp.
Combining the forward serial-interval distribution with the serial reproduction number completes the renewal process between symptomatic cases:
\begin{equation}
j(t) = \int_{-\infty}^\infty \Rs(t-\tau) j(t-\tau) f_{t-\tau}(\tau) \dtau.
\label{eq:jrenew}
\end{equation}
This framework allows us to understand changes in the realized serial intervals for any epidemic model and properly link serial-interval distributions with the renewal process.

\subsection{Epidemic model}

We illustrate changes in forward and backward serial intervals over the course of an epidemic by applying it to a specific example of an epidemic model.
We model disease spread with a renewal-equation model \citep{heesterbeek1996concept, diekmann2000mathematical, roberts2004modelling, aldis2005integral, roberts2007model, champredon2018equivalence}.
Ignoring births and deaths, general changes in the proportion of susceptible individuals $S(t)$ and incidence of infection $i(t)$ can be described as:
\begin{align}
\frac{\mathrm{d}S}{\mathrm{d}t} &= - i(t)\nonumber\\
i(t) &= \RR(t) \int_0^\infty i(t-\tau) \gdist(\tau) \dtau,
\label{eq:renewal}
\end{align}
where $\RR(t)$ is the instantaneous reproduction number (i.e., the average number of secondary cases that a primary case infected at time $t$ will generate if conditions at time $t$ remains unchanged \citep{fraser2007estimating}), and $\gdist(\tau)$ is the intrinsic generation-interval distribution (i.e., the forward generation-interval distribution of a primary case in a population where changes in $\RR(t)$ is negligible \citep{champredon2015intrinsic}).
This model effectively assumes that epidemic dynamics are driven by changes in transmission rate, which may not hold under individual-based intervention such as case isolation \citep{fraser2007estimating};
nonetheless, this form has been widely used in the literature and has been successfully applied in modeling the current COVID-19 pandemic \citep{gostic2020practical}.

Here, we consider a specific example where changes in the reproduction number is driven by susceptible depletion: $\RR(t) = \Ro S(t)$, where \Ro represents the basic reproduction number.
Although we do not consider non-pharmaceutical interventions explicitly, the effect of susceptible depletion is mathematically equivalent to the effect of interventions that reduce transmission rate.
Then, the forward generation-interval for a cohort of individuals that were infected at time $\psymp$ follows \citep{champredon2015intrinsic}:
\begin{equation}
\gdist_\psymp (\tau) = \frac{ \gdist(\tau) S(\psymp + \tau)}{\int_0^\infty \gdist(\tau') S(\psymp + \tau') \dtau'},
\end{equation}
which allows us to separate the joint probability distribution $h_\psymp$ of the forward incubation period and the forward generation-interval distribution as a product of the proportion of susceptible individuals $S$ and the joint probability distribution $h$ of the forward incubation period and the intrinsic generation intervals:
\begin{equation}
h_\psymp (x, \tau) = \frac{h(x, \tau) S(\psymp + \tau)}{\int_0^\infty \int_0^\infty h(x', \tau') S(\psymp + \tau') \dtau' \dx'}.
\end{equation}
We further assume that the forward incubation period distribution does
not vary across cohorts over the course of an epidemic, as it
represents the life history of a disease; we denote it as $\idist$.
Then, we have:
\begin{align}
\idist(x) &= \int_0^\infty h(x, \tau) \dtau\nonumber,\\
\gdist(\tau) &= \int_0^\infty h(x, \tau) \dx.
\label{eq:marginal}
\end{align}
Finally, the case reproduction for this model is defined as follows:
\begin{equation}
\Rc(t) = \Ro \int_0^\infty \gdist(\tau) S(t+\tau) \dtau.
\end{equation}
The forward and backward serial-interval distributions are then calculated by substituting these quantities into \eref{fserial} and \eref{bserial}.
We use this framework to illustrate how the realized epidemiological time distributions vary over the course of an epidemic and depend on the perspective (i.e., forward vs. backward).

\subsection{Linking $r$ and \RR}

During the initial phase of an epidemic, the proportion susceptible remains approximately constant ($S(t) \approx S(0)$) and incidence of infection grows exponentially: $i(t) \approx i_0\exp(rt)$.
During this period, the intrinsic generation-interval distribution provides the correct link between the exponential growth rate $r$ and the initial reproduction number $\RR=\Ro S(0)$ based on the Euler-Lotka equation \citep{wallinga2007generation}.
Here, we focus on the estimates of the basic reproduction number \Ro (the value of \RR in a fully susceptible population, $S(t) \approx 1$):
\begin{equation}
\frac{1}{\Ro} = \int_0^\infty \exp(-r\tau) g(\tau) \dtau.
\label{eq:Rgen}
\end{equation}
Analogous to the intrinsic generation-interval distribution, 
forward serial-interval distributions describe the renewal process of infection based on symptom onset dates.
Therefore, we expect the forward serial-interval distribution during the exponential growth phase --- which we refer to as the \emph{initial} forward serial-interval distribution $f_0$ --- to estimate the same value of \Ro for a given $r$ as the intrinsic generation-interval distribution (note, however, that the forward serial interval is not necessarily positive):
\begin{equation}
\frac{1}{\Ro} = \int_{-\infty}^\infty \exp(-r\tau) f_{0}(\tau) \mathrm{d} \tau,
\label{eq:Rforward}
\end{equation}
where the initial forward serial-interval distribution is given by:
\begin{equation}
f_{0}(\tau) = \frac{1}{\phi} \int_{-\infty}^{0} \int_{\pinf}^{\tau} \exp(r \pinf) h(-\pinf, \sinf - \pinf) \idist(\tau - \sinf) \, \mathrm{d}\sinf\,\mathrm{d}\pinf,
\label{eq:initialSI}
\end{equation}
where the normalization constant $\phi$ is determined by the
requirement that $\int_{-\infty}^\infty f_{0}(\tau)\,\dtau=1$.
Since we have not yet made any assumptions about the shape of the joint distribution $h$ between incubation periods and the generation intervals, this conclusion is robust, regardless of whether presymptomatic is possible or not.
It is straightforward to see this relationship from \eref{jrenew} (by substituting $j(t) \approx j(0) \exp(rt)$ and $\Rs(t) \approx \Ro$);
in Supplementary Materials, we provide a more detailed mathematical proof of this relationship.

We further compare this with the estimate of \Ro based on the intrinsic serial-interval distribution $q(\tau)$:
\begin{equation}
\frac{1}{\Rintrinsic} = \int_{-\infty}^\infty \exp(-r\tau) q(\tau) \mathrm{d} \tau.
\label{eq:Rintrinsic}
\end{equation}
Here, the intrinsic serial-interval distribution $q(\tau)$ does not depend on epidemic dynamics:
\begin{equation}
q(\tau) = \frac{1}{\phi_q} \int_{-\infty}^{0} \int_{\pinf}^{\tau} h(-\pinf, \sinf - \pinf) \idist(\tau - \sinf) \, \mathrm{d}\sinf\,\mathrm{d}\pinf,
\label{eq:intrinsicSI}
\end{equation}
where the normalization constant $\phi_q$ is determined by the
requirement that $\int_{-\infty}^\infty q(\tau)\,\dtau=1$.
Rather than numerically integrating over closed forms of $g$, $f_0$, and $q$ to estimate $\Ro$, we use simulation-based approaches for simplicity (Supplementary Materials).

The initial forward serial-interval distribution depends on the exponential growth rate $r$.
For a fast-growing epidemic (high $r$), we expect the backward incubation periods to be short (\eref{backexp}), meaning that presymptomatic transmission is less likely to occur; 
therefore, the initial forward serial-interval distribution will generally have a larger mean than the intrinsic generation- and serial-interval distributions.
However, the exact shape of the initial forward serial-interval distribution depends on the shape of the joint distribution.
For example, the Susceptible-Exposed-Infected-Recovered model, under the additional assumption that the incubation and exposed periods are equivalent (i.e. that onset of symptoms and infectiousness occur simultaneously), provides a special case where the forward serial- and generation-intervals follow the same distributions during the exponential growth phase because (i) infected individuals can only transmit after symptom onset and (ii) the time between symptom onset and infection is independent of the incubation period of an infector (see Supplementary Materials).
Throughout the paper, we allow for presymptomatic transmission to match the transmission dynamics of COVID-19.

\subsection{Model parameterization}

We have shown that the dynamics of the serial-interval distribution depends on the joint distribution between incubation periods and generation intervals.
Here, we use a bivariate lognormal distribution to model the joint probability distribution $h$ of intrinsic incubation periods and intrinsic generation intervals (in the renewal equation model, \eref{renewal}) while allowing for the possibility that they might be correlated.
Given that the viral load of SARS-CoV-2 peaks around the time of symptom onset, we generally expect the generation intervals to be positively correlated with the incubation period:
that is, individuals who develop symptoms later are more likely to transmit later.
Marginal distributions of incubation periods and generation intervals are parameterized based on parameter estimates for COVID-19 (Table 1).
For simplicity, we consider four values for the correlation coefficients (on the log scale) of the bivariate lognormal distribution: $\rho = 0, 0.25, 0.5, 0.75$.
This parameterization allows for generation intervals to be shorter than the incubation period, allowing for presymptomatic transmission.

\begin{table}[!ht]
\begin{center}
\begin{tabular}{|l|l|r|}
\hline
Parameter & Values & Source\\
\hline
Mean intrinsic incubation period & 5.5 days & \cite{lauer2020incubation} \\
SD intrinsic incubation period & 2.4 days & \cite{lauer2020incubation} \\
Mean intrinsic generation interval & 5 days & \cite{ferretti2020quantifying} \\
SD intrinsic generation interval & 2 days & \cite{ferretti2020quantifying} \\
\hline
\end{tabular}
\end{center}
\caption{
  \textbf{Parameter values used for simulations.}
The intrinsic generation-interval distribution is parameterized using a log-normal distribution with log mean $\mu_G=1.54$ and log standard deviation $\sigma_G=0.37$.
The intrinsic incubation period distribution is parameterized using a log-normal distribution with log mean $\mu_I=1.62$ and log standard deviation $\sigma_I=0.42$.
The joint probability distribution is modeled using a bivariate log-normal distribution with correlations (on the log scale) $\rho=0, 0.25, 0.5, 0.75$.
The intrinsic generation-interval and incubation period distributions are chosen to match characteristic of COVID-19 to illustrate realistic magnitudes of time-varying/perspective effects in the current pandemic.
}
\end{table}

\section{Results}

We use parameter estimates for COVID-19 to characterize the degree to which the realized serial-interval distribution can change over the course of the epidemic and evaluate how different definitions of the serial-interval distribution can affect the Euler-Lotka estimates of \Ro.
We further address how the observed serial intervals, measured through contact tracing, are affected by the right censoring during an ongoing epidemic and provide a heuristic method for addressing biases that can arise from using serial interval data to estimate \Ro.
Finally, we analyze the serial interval data from the COVID-19 epidemic in China under our framework.

\subsection{Realized serial-interval distributions}

\fref{rR} shows Euler-Lotka estimates of \Ro\ on different definitions of the serial interval. 
When the initial forward serial-interval distributions $f_0(\tau)$ is used, estimates (from \eref{Rforward}) exactly match the (correct) generation-interval-based estimates (\eref{Rgen}) for all values of the correlation $\rho$ between the intrinsic incubation period and the intrinsic generation interval (\fref{rR}A).
When the intrinsic distributions are used, however, estimates based on the serial interval (\eref{Rintrinsic}) underestimate \Ro: as $r$ increases, \Rintrinsic saturates and eventually \emph{decreases} due to the increasing inferred importance of negative serial intervals (\fref{rR}B).
While the initial forward serial intervals during the exponential growth phase can also be negative, their effects are appropriately balanced because faster epidemic growth leads to longer serial intervals (and a corresponding lower proportion of negative intervals).

\begin{figure}[!th]
\includegraphics[width=\textwidth]{rR.pdf}
\caption{
\textbf{Estimates of the reproduction number from the exponential growth rate based on serial- and generation-interval distributions.}
(A). The initial forward serial-interval distributions give a correct
link between the exponential growth rate $r$ and the reproduction
number \Ro,
for any correlation $\rho$ between intrinsic incubation period and
intrinsic generation interval of the underlying bivariate log-normal distribution.
(B) The intrinsic serial-interval distributions give an incorrect link between $r$ and \Ro.
(C) The mean initial forward serial interval during the exponential growth phase increases with $r$.
(D) The squared coefficient of variation of the initial forward serial intervals during the exponential growth phase decreases with $r$.
}
\label{fig:rR}
\end{figure}

Comparing the shapes of the initial forward serial-interval distribution (\eref{initialSI}) and the intrinsic generation-interval distribution allows us to better understand how different forward distributions lead to identical estimates of \Ro.
In general, distributions with higher means and less variability lead to higher \Ro for a given $r$ \citep{wallinga2007generation, weitz2015modeling, park2019practical}.
When incidence is growing exponentially, forward serial intervals have higher means (\fref{rR}C) and squared coefficients of variation (\fref{rR}D) than the intrinsic generation-interval distribution.
The effects of higher means (which increase \Ro) exactly cancel those of higher variability (which decrease \Ro).
On the other hand, \emph{intrinsic} serial intervals (\eref{intrinsicSI}) have the same mean (equal to the mean initial forward serial at $r=0$ in \fref{rR}C) as the intrinsic generation intervals but are more variable (also see squared coefficient of variation of the initial forward serials at $r=0$ in \fref{rR}D); 
therefore, we underestimate \Ro when we use the intrinsic serial-interval distribution.

\begin{figure}[!ht]
\begin{center}
\includegraphics[width=0.95\textwidth]{forward.pdf}
\caption{
\textbf{Epidemiological dynamics and changes in mean forward and backward delay distributions.}
(A) Daily incidence over time.
(B--D) Changes in the mean forward incubation period, generation interval, and serial interval.
(E--G) Changes in the mean backward incubation period, generation interval, and serial interval.
Black lines represent the results of a deterministic simulation.
Orange lines (A) represent the results of 10 stochastic simulations.
Orange points (B-G) represent the average of 10 stochastic simulations.
Dashed lines represent the mean initial forward delay.
Intrinsic incubation periods and intrinsic generation-intervals are assumed to be independent of each other.
See Table 1 for parameter values.
}
\label{fig:epi}
\end{center}
\end{figure}

The initial forward serial-interval distribution captures the exponential growth phase of an epidemic.
We now explore how forward and backward serial intervals can vary over the course of an epidemic using deterministic and stochastic simulations based on the renewal equations (see Supplementary Materials) using parameters in Table 1;
we further assume $\Ro=2.5$ to reflect the transmission dynamics of COVID-19 in China \citep{doi:10.1098/rsif.2020.0144}.
While the forward serial-interval distribution is our primary focus, understanding the differences between the forward and the backward distributions is important because the observed intervals during an ongoing epidemic are often the backward ones:
we typically identify infected individuals and ask when and by whom they were infected.
Similarly, when we are estimating the incubation period of an individual, we typically observe their symptom onset date and try to estimate when they were infected (e.g., \cite{backer2020incubation}).

\fref{epi} shows the epidemiological dynamics (A) together with the mean forward (B--D) and the mean backward (E--G) delay distributions of a deterministic model based on the renewal equation (\eref{renewal}) and of the corresponding stochastic realizations based on individual-based simulations.
The mean forward incubation period remains constant throughout an epidemic by assumption (\fref{epi}B).
The mean forward generation interval decreases slightly when incidence is high, which is when the susceptible population declines rapidly (\fref{epi}C; \cite{kenah2008generation, champredon2015intrinsic}).
In contrast, the mean forward serial interval decreases over time (\fref{epi}D).

The forward serial-interval distributions depend on distributions of three intervals
(\fref{diagram}): (i) the backward incubation period, (ii) the forward generation interval, and (iii) the forward incubation period.
In these simulations, both forward incubation period (\fref{epi}B) and generation-interval (\fref{epi}C) distributions remain roughly constant;
therefore, changes in the forward serial-interval distributions (\fref{epi}D) are predominantly driven by changes in the backward incubation period distribution, whose mean increases over time as the growth rate of disease incidence slows, then becomes negative.
In general, relative contributions of the three distributions depend on their shapes, correlations between intrinsic incubation periods and generation intervals, and overall epidemiological dynamics.

We see similar qualitative patterns in all three backward delays (\fref{epi}E--G; \eref{backward}), because they are predominantly driven by the rate of change in incidence, which in turn affects relative cohort sizes.
When incidence is increasing, individuals are more likely to have been infected recently and therefore, we are more likely to observe shorter intervals (\eref{backexp}).
Similarly, when incidence decreases, we are more likely to observe longer intervals.
Neglecting these changes in the backward distributions will necessarily bias the inference of the intrinsic distributions from the observed distributions.

Stochastic simulations confirm our deterministic calculations albeit minor differences due to transient dynamics.
Incidence trajectories of stochastic simulations are slightly shifted (\fref{epi}A) due to differences in initial conditions. 
We set the distribution of infection time of initially infected individuals (beginning from a small number of infected individuals) for deterministic simulations such that the system can exhibit exponential growth immediately (Supplementary Materials).
This is not possible for stochastic simulations because the number of initially infected individuals cannot be smaller than 1; instead, we begin with 10 infected individuals who are infected at time $t=0$.
In addition, the mean backward intervals of stochastic simulations begins from smaller values due to left-censoring.

\subsection{Observed serial-interval distributions}

\begin{figure}[!ht]
\includegraphics[width=\textwidth]{diagram.pdf}
\caption{
\textbf{Estimating the reproduction number from the observed serial intervals.}
(A) Schematic representation of line list data collected during an epidemic.
(B) Estimates of \Ro based on all observed serial intervals completed by a given time.
(C) Schematic representation of line list data rearranged by symptom onset date of infectors.
(D) Estimates of \Ro based on all observed serial intervals started by a given time. 
Black dashed lines represent the mean initial forward serial interval and \Ro.
Black solid lines represent the mean intrinsic serial interval and \Rintrinsic.
Colored solid lines represent the mean estimates of \Ro across 10 stochastic simulations.
Colored ribbons represent the range of estimates of \Ro across 10 stochastic simulations.
}
\label{fig:obsrR}
\end{figure}

Now, we turn to practical issues of estimating the reproduction number from the observed serial-interval data during on ongoing epidemic.
In order to have an unbiased estimate of the basic reproduction number, we need to estimate the initial forward serial-interval distribution --- i.e., serial intervals based on cohorts of infectors who share the same symptom onset time, at the early stage of the epidemic.
However, researchers typically use all available information to estimate epidemiological parameters (e.g., aggregating all serial intervals observed until certain time of an epidemic);
for example, \cite{thompson2019improved} recently suggested that up-to-date serial-interval data are necessary to accurately estimate the reproduction number.
We explore the consequences of neglecting changes in the realized serial-interval distribution on estimates of the basic reproduction number.

When an epidemic is ongoing, the observed serial intervals are subject to right-censoring because we cannot observe a serial interval if either an infector or an infectee has not yet developed symptoms;
for example, if we were to measure serial intervals on Day 8 as in \fref{obsrR}A, we will only be able to observe the first 6 events (ID 1--6).
\fref{obsrR}B demonstrates how the effect of right-censoring in the observed serial intervals translates to the underestimation of the basic reproduction number \Ro in our stochastic simulations (assuming $\Ro = 2.5$ as in \fref{epi}).
Notably, even if we could observe, and aggregate, \emph{all} serial intervals across all transmission pairs after the epidemic has ended, we would still underestimate the initial mean forward serial interval (and therefore \Ro), likely by a large amount, because the observed serial-interval distribution converges to the intrinsic serial-interval distribution (as the incubation periods and generation intervals will no longer be subject to backward biases);
in fact, we would even underestimate the intrinsic value slightly due to contraction of the forward generation-interval distribution during the susceptible depletion phase (\fref{epi}C).
Therefore, aggregated distributions of serial intervals that have been collected throughout different periods of an epidemic should be interpreted with care.

Here, we provide a heuristic way of assessing potential biases in the estimate of the mean initial forward serial interval and therefore \Ro retrospectively.
We can rearrange the line list and group observed serial intervals based on the symptom onset date of infectors (\fref{obsrR}C)---as we showed earlier, serial intervals that share the same symptom onset date of a primary case give us the forward serial-interval distribution.
Then, we can compare how the shape of the serial-interval distribution (particularly its mean) as well as the estimate of \Ro change as we incorporate more recent cohorts into the analysis:
that is, we analyze observed serial intervals from infectors who became symptomatic before time $t$ and evaluate how the estimates change as we increase $t$.
This approach is analogous to averaging over a set of forward intervals, just as using all information up to a certain time is analogous to averaging over a set of backward intervals (\fref{obsrR}D);
the major difference is that we we focus on serial intervals that begin in a certain period, rather than those that end in a certain period.
During the exponential growth phase, the estimates of the mean serial interval and \Ro are consistent with the true value (see `initial forward' in \fref{obsrR}B,D);
adding more data allows us to make more precise inference during this period.
However, the cohort-averaged estimates decrease rapidly soon after the exponential growth period, reflecting changes in the forward serial-interval distributions.
This approach allows us to detect dynamical changes in the forward serial-interval distributions and their effect on the estimates of \Ro.

\subsection{Applications to the COVID-19 pandemic}

\begin{figure}[!th]
\includegraphics[width=\textwidth]{serial_analysis.pdf}
\caption{
\textbf{Observed serial intervals of COVID-19 and cohort-averaged estimates of \RR.}
(A) Symptom onset dates of all individuals within 468 transmission pairs in the data.
(B--C) forward and backward serial intervals over time.
Serial interval data have been grouped based on the symptom onset dates of primary (B) and secondary (C) cases.
Points represent the means. 
Vertical error bars represent the 95\% equi-tailed quantiles.
Solid lines represent the estimated locally estimated scatterplot smoothing (LOESS) fits.
The dashed line represents the maximum and minimum observable delays across the range of reported symptom onset dates.
(D) Cohort-averaged estimates of \Ro assuming doubling period of 6 and 8 days \citep{li2020early, wu2020nowcasting}.
Ribbons represent the associated 95\% bootstrap confidence intervals.
The data were taken from Supplementary Materials of \cite{du2020serial}.
}
\label{fig:du}
\end{figure}

Finally, we re-analyze serial intervals of COVID-19 collected by \cite{du2020serial} from mainland China, outside Hubei province, based on 468 transmission events reported between January 21--February 8, 2020;
\cite{du2020serial} estimated the mean serial interval of 3.96 days (95\% CI 3.53–4.39 days) and \Ro of 1.32 (95\% CI 1.16–1.48).
\fref{du}A shows the distribution of symptom onset dates of all individuals within 468 transmission pairs (consisting a total of 752 unique individuals), resembling a COVID-19 epidemic curve in China (cf. Fig. 1 in \citep{pan2020jama}).
In order to quantify changes in serial intervals, we group them by the symptom onset dates of the primary (\fref{du}B) and secondary (\fref{du}C) cases---corresponding to forward and backward serial-interval distributions, respectively---and compute their mean and 95\% quantiles.
\fref{du}B shows that the mean forward serial interval decreases over time.
While the decrease is likely to be affected by the right-censoring (indicated by the closeness between the quantiles of the observed serial intervals and maximum observable serial intervals), the increase in the proportion of negative serial intervals indicates changes in the forward serial-interval distribution;
this proportion is unlikely to be affected by left-censoring (based on the gap between the quantiles of the observed serial intervals and minimum observable serial intervals).
The decrease in the mean forward serial interval was probably driven by interventions against spread.
Interventions during this time period both decreased (and then reversed) the growth rate of COVID-19 cases --- thus increasing the backward incubation period --- and also reduced generation intervals, by preventing infections once cases were identified.
Both of these would have acted to reduce the forward serial interval.
\fref{du}C shows that the mean backward serial interval increased over time, also likely driven directly by the decrease in COVID-19 infections.

While the qualitative changes in the mean forward and backward serial interval are consistent with our earlier simulations (\fref{epi}), the initial mean forward serial interval (\fref{du}B) appears to be larger than what we calculated based on previously estimated incubation period and generation-interval distributions (\fref{rR}C).
These may imply that the incubation period and generation interval (Table 1) were underestimated, as neither study explicitly accounted for the fact that the observed intervals were drawn from the backward distributions and were likely to have been censored.

\fref{du}D shows the cohort-averaged estimates of \Ro, which remain roughly constant until day 7 and suddenly decreases;
this sudden decrease is due changes in the forward serial intervals consistent with the dynamics seen in our simulations (\fref{obsrR}).
The cohort-averaged estimates of \Ro based on the early forward serial intervals are also consistent with previous estimates of \Ro of the COVID-19 epidemic in China \citep{majumder2020early, doi:10.1098/rsif.2020.0144}:
$\Ro = 2.6$ (95\% CI: 2.2--3.1) and $\Ro = 3.4$ (95\% CI: 2.7 -- 4.3) based on a doubling period of 8 or 6 days, respectively, using serial-interval data from infectors who developed symptoms by day 7.
These early cohort-averaged estimates of \Ro are unlikely to be affected by the right-censoring as we expect the degree of right-censoring to be low (\fref{du}A).
Therefore, the original \Ro estimate of 1.32 (95\% CI 1.16-–1.48), which neglects the changes in the forward serial-interval distribution, underestimates \Ro by 50\%--60\%.
This example demonstrates the danger of using the observed serial intervals to calculate the reproduction number without organizing serial intervals into cohorts.

\section{Discussion}

Generation and serial intervals determine the time scale of disease transmission, and are therefore critical to dynamical modeling of infectious outbreaks.
Here, we show that the initial \emph{forward} serial-interval distribution --- measured from the cohort of infectors who developed symptoms during the exponential growth phase of an epidemic --- provides the correct link between the exponential growth rate $r$ and the initial reproduction number \RR.
In general, the forward serial-interval distributions will not match the intrinsic serial-interval distribution (which has the same mean as the intrinsic generation-interval distribution) because the incubation period of the infectors (conditional on their symptom onset date of the infector) will be subject to backward biases.
In particular, the mean forward serial interval can decrease over time for COVID-19 as individuals who develop symptoms later in an epidemic are more likely to have longer incubation periods, and therefore have greater opportunity to transmit presymptomatically.
Failing to account for these effects can result in underestimation of initial \RR.

Recently, \cite{ali2020serial} also showed that serial intervals of COVID-19 decreased in China. Analogous to our approach, they also grouped serial intervals by the symptom onset date of infectors across 14-day periods and found that the mean forward serial interval decreased from 7.8 days to 2.6 days.
While they attributed the decrease in serial intervals to reduction of the isolation delay, their regression analysis showed that isolation delays explain only 51.5\% of the variation in serial intervals (and explaining up to 72\% of the variance including other intervention measures).
Our framework provides an explanation for the remaining variation: changes in the backward incubation period during the decreasing phase of an epidemic also shorten serial intervals due to increased amount of presymptomatic transmission (even in the absence of nonpharmaceutical interventions).
Since isolation delays and other intervention measures affect the amount of onward transmission, and therefore the distribution of realize (forward) generation intervals, it cannot explain all variation in forward serial intervals, which depend on (i) backward incubation period of the infector, (ii) the forward generation interval, and (iii) the forward incubation period of the infectee (\fref{diagram}B).

Our results support the use of serial-interval distributions for calculating the initial \RR during the exponential growth phase,  
but they also reveal gaps in current practices in incorporating serial-interval distributions into outbreak analyses.
For example, \cite{thompson2019improved} recently emphasized the importance of using up-to-date serial-interval data for accurate estimation of time-varying reproduction numbers.
However, our results show that if changes the forward serial interval through time are not accounted for, using up-to-date serial-interval data can, in fact, exacerbate the underestimation of initial \RR.
Future studies should explore how neglecting changes in the forward serial-interval distribution can affect the estimates of \RR beyond the exponential growth phase and potentially re-assess existing estimates of \RR.
We also suggest that modelers should aim to characterize spatiotemporal variation in forward serial-interval distributions and understand their changes over time.
These modeling approaches should be coupled with epidemiological investigation through contact tracing. 
Going forward, an additional advantage of early, intensive contact tracing of emerging diseases is that this is the best way to characterize the initial forward serial-interval distribution.

Our study also underlines the fact that the serial-interval distribution depends not only on the generation-interval and incubation-period distributions, but also on their intrinsic correlations.
Here, we use a bivariate lognormal distribution to capture their correlations phenomenologically but their true correlations will depend on viral load dynamics;
nonetheless, we expect our conclusions about decreasing serial intervals of COVID-19 to be robust as individuals with longer incubation periods have longer time window to transmit before symptom onset.
Otherwise, the impact of increasing backward incubation periods on the forward serial intervals are likely to be disease specific---for example, we show in Supplementary Materials that the initial forward serial-interval distribution can be equivalent to the intrinsic generation-interval distribution, regardless of the growth rate $r$, due to independence between the incubation period and time from symptom onset to transmission (assuming no transmission occurs during the incubation period).
This implies that not considering this correlation can potentially bias the estimates of the intrinsic generation-interval distribution from the serial-interval distribution.
% Previous studies that tried to estimate the generation-interval distributions from the observed serial intervals often ignored the dynamical differences between the realized incubation periods of infectors (backward-looking) and those of infectees (forward looking) (e.g., \cite{klinkenberg2011correlation, ganyani2020estimating}).
Better statistical tools for teasing apart the intrinsic generation-interval distributions from the observed serial intervals are needed.

Here, we lay out a few practical principles for analyzing and interpreting the serial interval data.
First, serial intervals should be cohorted based on the symptom onset date whenever possible.
Previous studies have often regarded serial intervals as an intrinsic quantity, having the same mean as the intrinsic generation interval \citep{svensson2007note,klinkenberg2011correlation,champredon2018equivalence, britton2019estimation}, but their distributions are expected to change due to epidemic dynamics.
Even when all realized serial intervals can be observed throughout an unmitigated epidemic, we do not obtain the intrinsic serial interval distribution due to susceptible depletion (\fref{obsrR})---something true of realized generation intervals as well \citep{park2020inferring}.
Second, aggregating serial intervals across different cohorts and epidemic periods should be avoided as they can be subject to different censoring and epidemiological biases.
Third, applying serial interval information from one epidemic to another should be avoided, even for same diseases, because serial intervals are epidemic-specific, rather than disease-specific.
Finally, serial interval data should be accompanied by a trajectory of the epidemic curve, whenever possible, to properly assess them within the epidemiological context.
In practice, these recommendations can be still difficult to follow due to limited serial interval information;
nonetheless, we believe that following these approaches will help interpret serial interval data and understand transmission dynamics at the individual-level.

More broadly, our study underlines the importance of carefully defining measured epidemiological time distributions. 
Previous studies have shown that it matters whether generation
intervals are measured forward or backward \citep{nishiura2010time,champredon2015intrinsic,britton2019estimation};
we generalize these ideas and show that they apply to any other epidemiological distributions.
Some studies during the early phases of the COVID-19 epidemics have tried to correct for the backward biases, but changes in the backward delay distributions due to changing cohort sizes are expected to be a pervasive feature of outbreak dynamics.
Cohorting epidemiological delays by the primary event time can help avoid backward biases (although censoring biases can still exist) as well as detect potential changes in the distribution.

Here, we assume that all individuals develop symptoms and that the entire transmission process, including all relevant epidemiological delays, is known exactly.
In practice, identifying who infected whom is difficult in general, and asymptomatic and presymptomatic transmission of COVID-19 exacerbates this difficulty \citep{bai2020presumed,he2020temporal,wei2020presymptomatic}.
Biases in the observed serial intervals will necessarily bias the estimates of \RR. 
Furthermore, when one of the individuals is asymptomatic, there is no symptom-based serial interval; 
neglecting the time scale asymptomatic transmission may also bias the estimates of \RR \citep{park2020time}.

Despite these limitations, our analysis of serial intervals of COVID-19 from China provides further support for our theoretical framework, demonstrating temporal variation in serial intervals and its effect on the estimates of \RR.
Most existing estimates of the serial-intervals of COVID-19 implicitly or explicitly assume that the serial-interval distributions remain constant throughout the course of an epidemic \citep{du2020serial, he2020temporal, nishiura2020serial,tindale2020transmission,zhao2020estimating,zhang2020evolving}.
Our study provides a rationale for reassessing estimates of
serial-interval distributions---and their use in estimating
\RR---during the COVID-19 pandemic.

\pagebreak

\section{Supplementary Materials}

\subsection{Deterministic simulation}

We simulate the renewal equation model using a discrete-time approximation:
\begin{align}
i(t) &= \Ro S(t-\Delta t) \sum_{m=1}^{\tsub{m}{max}} i(t-m \Delta t) \hat{\gdist}(m \Delta t) \nonumber \\
S(t) &= S(t-\Delta t) - i(t)
\end{align}
where $\hat{\gdist}$ is a discrete-time intrinsic generation-interval distribution that satisfies the following:
\begin{equation}
\hat{\gdist}(m \Delta t) = \frac{\gdist(m \Delta t)}{\sum_{i=1}^\ell \gdist(m \Delta t)}, \quad m=1, \dots, \tsub{m}{max}.
\end{equation}
The continuous-time intrinsic generation-interval distribution is parameterized using a log-normal distribution (Table 1). We define the intrinsic incubation period distribution in a similar manner:
\begin{equation}
\hat{\idist}(m \Delta t) = \frac{\idist(m \Delta t)}{\sum_{i=1}^\ell \idist(m \Delta t)}, \quad m=1, \dots, \tsub{m}{max},
\end{equation}
where its continuous-time analog is also based on a log-normal distribution.
For simplicity, we assume that the forward incubation periods and intrinsic generation intervals are independent:
\begin{equation}
\hat{h}(m \Delta t, n \Delta t) = \hat{\idist}(m \Delta t)\hat{\gdist}(n \Delta t), \quad m,n=1, \dots, \tsub{m}{max}.
\end{equation}
We use $\Delta t = 0.025\,\textrm{days}$ and $\tsub{m}{max}=2001$ for discretization steps.

We initialize the simulation with population size $N$=40,000 as follows:
\begin{align}
i(m \Delta t) &= C \exp(r m \Delta t), \quad m=1, \dots, \tsub{m}{max}\nonumber \\
S(m \Delta t) &= N - \sum_{n=1}^m i(n \Delta t), \quad m=1, \dots, \tsub{m}{max}
\end{align}
where $C$ is chosen such that $\sum_{n=1}^{\tsub{m}{max}} i(m \Delta t)=10$.
These initial conditions allow the model to follow exponential growth from time $\Delta t (\tsub{m}{max} + 1)$ without any transient behaviors.
Results presented in the main text show simulations beginning from time $\Delta t (\tsub{m}{max} + 1)$.

\subsection{Stochastic simulation}

We run stochastic simulations of the renewal equation model using an individual-based model on a fully connected network (i.e., homogeneous population) based on the Gillespie algorithm that we developed earlier \citep{park2020inferring}.
First, we initialize an epidemic with $I(0)$ infected individuals (nodes) in a fully connected network of size $N$. 
For each initially infected individual, we draw number of infectious contacts from a Poisson distribution with the mean of \Ro and the corresponding generation intervals for each contact from a log-normal distribution (Table 1).
Contactees are uniformly sampled from the total population.
All contactees are sorted into event queues based on their infection time.
We update the current time to the infection time of the first person in the queue.
Then, the first person in the queue makes contacts based on the Poisson offspring distribution described earlier and their contactees are added to the sorted queue.
Whenever contactees are added to the sorted queue, we remove all duplicated contacts (but keep the first one) as well as contacts made to individuals that have already been infected.
Simulations continue until there are no more individuals in the queue.
We simulate 10 epidemics with $I(0)=10$ and $N$=40,000.

\subsection{Linking $r$ and \Ro using serial-interval distributions}

The intrinsic generation-interval distribution $\gdist(\tau)$ provides a link between $r$ and \Ro via the Euler-Lotka equation \citep{wallinga2007generation}:
\begin{equation}
\frac{1}{\Ro} = \int_0^\infty \exp(-r\tau) \gdist(\tau) \dtau\,.
\end{equation}
In this section, we prove that the initial forward serial-interval distribution $f_0(\tau)$ also estimates the same \Ro from $r$, except that integral extends to $\tau=-\infty$ rather than beginning at $\tau=0$, because serial intervals can be negative:
\begin{equation}
\frac{1}{\Ro} = \int_{-\infty}^\infty \exp(-r\tau) f_{0}(\tau) \dtau\,.
\label{eq:ptarget}
\end{equation}
Here, the initial forward serial-interval distribution $f_{0}(\tau)$ is defined as:
\begin{equation}
f_{0}(\tau) = \frac{1}{\phi} \int_{-\infty}^{0} \int_{\alpha_1}^{\tau} \exp(r \alpha_1) h(-\alpha_1, \alpha_2 - \alpha_1) \idist(\tau - \alpha_2) \, \mathrm{d}\alpha_2\,\mathrm{d}\alpha_1\,,
\label{eq:fdist}
\end{equation}
where $h$ is the joint probability distribution describing the
intrinsic generation-interval distribution $g$ and the intrinsic
incubation period distribution $\idist$ (see \eref{marginal} in the
main text), and the normalization constant $\phi$ is determined by the
requirement that $\int_{-\infty}^\infty f_{0}(\tau)\,\dtau=1$.

In order to verify \eref{ptarget}, we first rewrite the integral in \eref{fdist} by substituting $-\alpha_1$ for $\alpha_1$, and then changing the order of integration:
\begin{align}
f_{0}(\tau) &= \frac{1}{\phi} \int_0^\infty \int_{-\pinf}^{\tau} \exp(-r\pinf) h(\pinf, \sinf + \pinf) \idist(\tau - \sinf)\, \mathrm{d}\sinf\,\mathrm{d}\pinf\,,\nonumber \\
&= \frac{1}{\phi} \int_{-\infty}^{\tau} \int_{\max{(0,-\sinf)}}^{\infty} \exp(-r\pinf) h(\pinf, \sinf + \pinf)\idist(\tau - \sinf)\,\mathrm{d}\pinf\, \mathrm{d}\sinf\,.
\label{eq:newforward}
\end{align}
To further simplify the expression, we define $z(\sinf)$ as follows:
\begin{equation}
z(\sinf) = \int_{\max{(0,-\sinf)}}^{\infty} \exp(-r\pinf) h(\pinf, \sinf + \pinf) \,\mathrm{d}\pinf\,.
\end{equation}
Substituting $z(\sinf)$ into \eref{newforward} we obtain:
\begin{equation}
f_{0}(\tau) = \frac{1}{\phi} \int_{-\infty}^{\tau} z(\sinf) \idist(\tau - \sinf) \,\mathrm{d}\sinf\,,.
\end{equation}
Writing $\hat{z}$ for a normalized version of $z$,
\begin{equation}\hat{z}(\sinf) = \frac{z(\sinf)}{\int_{-\infty}^\infty z(x) \dx}\,,\end{equation}
we can now express the initial forward serial-interval distribution
$f_0$ as a convolution of $\hat{z}$ and $\idist$:
\begin{equation}
f_{0}(\tau) = \frac{1}{\hat{\phi}} \int_{-\infty}^{\tau} \hat{z}(\sinf) \idist(\tau - \sinf)\, \mathrm{d}\sinf\,,
\end{equation}
where $\hat{\phi} = \phi/\int_{-\infty}^\infty z(x) \dx$.

Since the right hand side of \eref{ptarget} is also a
Laplace transform of $f_0=\hat{z}*\idist$, we can express it as the product
of Laplace transforms of $\hat{z}$ and $\idist$:
\begin{equation}
\int_{-\infty}^\infty \exp(-r\tau) f_{0}(\tau) \mathrm{d} \tau = \int_{-\infty}^\infty \exp(-r\tau) \hat{z}(\tau)\, \mathrm{d} \tau \int_{0}^\infty \exp(-r\tau) \idist(\tau) \dtau\,.
\label{eq:newtarget}
\end{equation}
In order to derive an expression for a Laplace transform of $\hat{z}$, we have to first derive an analytical expression for $\int_{-\infty}^\infty z(x) \dx$. By changing the order of integration, we have:
\begin{align}
\int_{-\infty}^\infty z(\sinf) \mathrm{d}\sinf &= \int_{-\infty}^\infty \int_{\max{(0,-\sinf)}}^{\infty} \exp(-r\pinf) h(\pinf, \sinf + \pinf)\, \mathrm{d}\pinf \,\mathrm{d}\sinf\nonumber\,,\\
&= \int_{0}^\infty \int_{-\pinf}^\infty \exp(- r \pinf) h(\pinf, \sinf+\pinf)\, \mathrm{d}\sinf\,\mathrm{d} \pinf\,.
\end{align}
Since $\idist$ is a marginal probability distribution of $h$, it follows that:
\begin{equation}
\int_{-\infty}^\infty z(\sinf) \mathrm{d}\sinf = \int_{0}^\infty \exp(- r \pinf) \idist(\pinf)\, \mathrm{d}\pinf\,.
\end{equation}
Then, we have:
\begin{equation}
\hat{z}(\sinf) = \frac{\int_{\max{(0,-\sinf)}}^{\infty} \exp(-r\pinf) h(\pinf, \sinf + \pinf)\, \mathrm{d}\pinf}{\int_{0}^\infty \exp(- r \pinf) \idist(\pinf)\, \mathrm{d}\pinf}\,.
\end{equation}
Substituting the expression into \eref{newtarget}, we have:
\begin{equation}
\int_{-\infty}^\infty \exp(-r\tau) f_{0}(\tau)\dtau = \int_{-\infty}^\infty \exp(-r\sinf) \int_{\max{(0,-\sinf)}}^{\infty} \exp(-r\pinf) h(\pinf, \sinf + \pinf)\, \mathrm{d}\pinf\,\mathrm{d}\sinf\,.
\label{eq:newtarget2}
\end{equation}

Recall that $g$ is also a marginal probability distribution of $h$:
\begin{equation}
g(\tau) = \int_0^\infty h(x, \tau) \,\mathrm{d}x\,.
\end{equation}
We can then substitute $\tau = \pinf + \sinf$ into \eref{newtarget2} and apply change of variables to obtain:
\begin{align}
&\int_{-\infty}^\infty \exp(-r\tau) f_{0}(\tau)\dtau\\
&=\int_{-\infty}^{\infty} \exp(-r\sinf) \int_{\max(0, -\sinf)}^\infty \exp(- r \pinf) h(\pinf, \sinf+\pinf) \,\mathrm{d} \pinf \,\mathrm{d}\sinf \\
&=\int_{0}^{\infty} \int_{0}^\infty \exp(- r \tau) h(\pinf, \tau)\, \mathrm{d} \pinf\, \mathrm{d}\tau\\
&=\int_{0}^{\infty} \exp(-r\tau) g(\tau) \dtau =\frac{1}{\Ro}
\end{align}
Therefore, the initial forward serial-interval distribution and the intrinsic generation-interval distribution give the same estimates of \Ro from $r$.\qed

\subsection{Comparing the estimates of \Ro using the initial forward and the intrinsic serial-interval distributions}

We use a simulation-based approach to compare the estimates of \Ro based on the serial- and generation-interval distributions. 
To do so, we model the intrinsic generation-interval distribution and the incubation period using a multivariate log-normal distribution with log means $\mu_G, \mu_I$, log standard variances $\sigma_G^2, \sigma_I^2$, and log-scale correlation $\rho$;
the multivariate log-normal distribution is parameterized based on parameter estimates for COVID-19 (Table 1).
We construct forward serial intervals during the exponential growth period as follows:
\begin{equation}
F_i = -X_{1,i} + (G_i|X_{1,i}) + X_{2,i},
\end{equation}
where the backward incubation period $X_{1,i}$ of an infector is simulated by drawing random log-normal samples $Y_i$ with log mean $\mu_I$ and log variance $\sigma_I^2$ and resampling $Y_i$, each weighted by the inverse of the exponential growth function $\exp(-rY_i)$;
the intrinsic generation interval conditional on the incubation period of the infector $(G_i|X_{1,i})$ is drawn from a log-normal distribution with log mean $\mu_G + \sigma_G \rho (\log(X_{1,i}) - \mu_I)/\sigma_I$ and log variance $\sigma_G^2 (1-\rho^2)$;
the forward incubation period $X_{2,i}$ of an infectee is drawn from a log-normal distribution with log mean $\mu_I$ and log variance $\sigma_I^2$.
We then calculate the basic reproduction number \Ro using the empirical estimator:
\begin{equation}
\Ro = \frac{1}{\frac{1}{N}\sum_{i=1}^N \exp(- r F_i)}.
\end{equation}
We compare this with an estimate of \Ro based on the intrinsic serial-interval distribution which has the same mean as the intrinsic generation-interval distribution \citep{svensson2007note,klinkenberg2011correlation,champredon2018equivalence, britton2019estimation}:
\begin{equation}
  \Rintrinsic = \frac{1}{\frac{1}{N}\sum_{i=1}^N \exp(- r Q_i)},
\end{equation}
where
\begin{equation}
Q_i = -Y_i + (G_i|Y_i) + X_{2,i}.
\end{equation}

\subsection{Applications: SEIR model}

Consider a Susceptible-Exposed-Infectious-Recovered model:
\begin{align}
\frac{\mathrm{d}S}{\mathrm{d}t} &= - \beta S I \nonumber \\
\frac{\mathrm{d}E}{\mathrm{d}t} &= \beta S I - \gamma_E E\nonumber\\
\frac{\mathrm{d}I}{\mathrm{d}t} &= \gamma_E E - \gamma_I I\nonumber \\
\frac{\mathrm{d}R}{\mathrm{d}t} &= \gamma_I I
\end{align}
where $\beta$ is the transmission rate, $1/\gamma_E$ is the mean latent period, and $1/\gamma_I$ is the mean infectious period.
We further assume that the latent period is equivalent to incubation period; in other words, infected individuals can only transmit after symptom onset.
Then, the generation interval will be always longer than the incubation period.

The joint probability distribution of the intrinsic incubation periods and intrinsic generation intervals for this model can be written as:
\begin{equation}
h(x, \tau) = \begin{cases}
0 & x > \tau\\
\gamma_I \gamma_E \exp(-\gamma_I (\tau-x)-\gamma_E x) & x \leq \tau
\end{cases}
\end{equation}
Then, the intrinsic generation-interval distribution is given by:
\begin{align}
g(\tau) &= \int_0^\tau h(x, \tau) \dx\nonumber \\
&= \frac{\gamma_I \gamma_E}{\gamma_E-\gamma_I} (\exp(-\gamma_I \tau) - \exp(-\gamma_E \tau))
\end{align}
On the other hand, the initial forward serial-interval distribution is given by:
\begin{align}
f_{0}(\tau) &\propto \int_{-\infty}^{0} \int_{0}^{\tau} \exp(r \pinf) h(-\pinf, \sinf - \pinf) \idist(\tau - \sinf) \, \mathrm{d}\sinf\,\mathrm{d}\pinf \nonumber \\
&\propto \int_{-\infty}^{0} \int_{0}^{\tau}\exp(r \pinf) \exp(-\gamma_I \sinf+ \gamma_E \pinf) \exp(-\gamma_E(\tau-\sinf)) \, \mathrm{d}\sinf\,\mathrm{d}\pinf \nonumber \\
&\propto  \exp(-\gamma_E \tau) \int_{-\infty}^{0} \int_{0}^{\tau} \exp((\gamma_E-\gamma_I) \sinf) \exp((r+ \gamma_E) \pinf)\, \mathrm{d}\sinf\,\mathrm{d}\pinf \nonumber \\
&\propto  (\exp(-\gamma_I \tau) - \exp(-\gamma_E \tau)) \int_{-\infty}^{0} \exp((r+ \gamma_E) \pinf)\,\mathrm{d}\pinf \nonumber \\
&\propto  \exp(-\gamma_I \tau) - \exp(-\gamma_E \tau)
\end{align}
Therefore, both the intrinsic generation intervals and the initial forward serial intervals are identically distributed and have the same mean.

\pagebreak

\bibliography{serial}

\end{document}
